!function(e,t){"object"==typeof exports&&"object"==typeof module?module.exports=t():"function"==typeof define&&define.amd?define([],t):"object"==typeof exports?exports.StoriesFs=t():e.StoriesFs=t()}(self,(()=>(()=>{"use strict";var e={d:(t,i)=>{for(var s in i)e.o(i,s)&&!e.o(t,s)&&Object.defineProperty(t,s,{enumerable:!0,get:i[s]})},o:(e,t)=>Object.prototype.hasOwnProperty.call(e,t)},t={};function i(e){e.userBtnPrev&&!e.userBtnPrev.classList.contains("disabled")&&e.userBtnPrev.classList.add("disabled"),e.defBtnPrev.classList.contains("disabled")||e.defBtnPrev.classList.add("disabled")}function s(e){e.userBtnPrev&&e.userBtnPrev.classList.contains("disabled")&&e.userBtnPrev.classList.remove("disabled"),e.defBtnPrev.classList.contains("disabled")&&e.defBtnPrev.classList.remove("disabled")}function n(e){e.userBtnNext&&!e.userBtnNext.classList.contains("disabled")&&e.userBtnNext.classList.add("disabled"),e.defBtnNext.classList.contains("disabled")||e.defBtnNext.classList.add("disabled")}function r(e){e.userBtnNext&&e.userBtnNext.classList.contains("disabled")&&e.userBtnNext.classList.remove("disabled"),e.defBtnNext.classList.contains("disabled")&&e.defBtnNext.classList.remove("disabled")}function o(e){null!==e&&e.forEach((function(e){clearInterval(e)}))}function l(e,t){var i=Math.pow(10,t);return~~(e*i)/i}function a(e,t,i,s){void 0===s&&(s=!1);var n,r=i.slidesPerView,o=c(e);if(s)return a(0),Number(o.window);function l(){var t;c(e),a((Object.keys(r).forEach((function(e,i){e<=Number(o.window)&&(t=r[e])})),t.count))}function a(e){t.forEach((function(t){var i=t;n=0===e?Number(o.wrapper):Number(o.wrapper)/e,i.style.flexBasis=n+"px"}))}function c(e){return{window:window.innerWidth,wrapper:e.clientWidth}}return null==r&&(r={320:{count:4},960:{count:6},1280:{count:8}}),l(),window.addEventListener("resize",(function(){l()})),n}e.d(t,{default:()=>c});const c=function(){function e(e,t){this.wrapperStoriesFsEl=".stories-fs__wrapper",this.trackStoriesFsEl=".stories-fs__track",this.slidesStoriesFsEl=".stories-fs__slide",this.activeIndexSlide=0,this.activeIndexStory=0,this.countScrollWrapper=0,this.playAnimScroll=!1,this.fullScreenMode=!1,this.countFirstActiveSlides=0,this.countLastActiveSlides=0,this.timerId=null,this.storyTimersId=null,this.optionsSfs=Object.assign({aspectRatioPreview:!0,autoPlayFullScreen:!1,storiesMode:!0,speedStory:3e3,speedAnimNextSlide:32,navigation:{elBtnPrev:null,elBtnNext:null}},t),this.initSfs(e,this.optionsSfs)}return e.prototype.initSfs=function(e,t){var i,s=this;return this.parentStoriesFs=document.querySelector(e),this.wrapperStoriesFs=this.parentStoriesFs.querySelector(this.wrapperStoriesFsEl),this.trackStoriesFs=this.wrapperStoriesFs.querySelector(this.trackStoriesFsEl),this.slidesStoriesFs=this.wrapperStoriesFs.querySelectorAll(this.slidesStoriesFsEl),null===this.parentStoriesFs?(console.error("Not found parent element"),!1):this.slidesStoriesFs.length<=0?(console.error("Not found slides elements"),!1):(t.aspectRatioPreview&&this.trackStoriesFs.classList.add("aspect-ratio"),this.widthSlide=a(this.wrapperStoriesFs,this.slidesStoriesFs,t),this.arrowsBtnEl=function(e,t){var i,s,n={};e.insertAdjacentHTML("afterbegin",'    \n        <div class="stories-fs__arrows">\n            <div class="stories-fs__arrow stories-fs__arrow--prev"></div>\n            <div class="stories-fs__arrow stories-fs__arrow--next"></div>\n        </div>');var r=e.querySelector(".stories-fs__arrows");if(t.navigation&&null!==(null===(i=t.navigation)||void 0===i?void 0:i.elBtnPrev)&&null!==(null===(s=t.navigation)||void 0===s?void 0:s.elBtnNext)){var o=document.querySelector(t.navigation.elBtnPrev),l=document.querySelector(t.navigation.elBtnNext);o&&(n.userBtnPrev=o,o.addEventListener("click",(function(){return d("prev")}))),l&&(n.userBtnNext=l,l.addEventListener("click",(function(){return d("next")}))),r.classList.add("hide-arrows")}var a=e.querySelector(".stories-fs__arrow--prev"),c=e.querySelector(".stories-fs__arrow--next");function d(t){e.dispatchEvent(new CustomEvent("changeSlide",{detail:{btn:"prev"===t?"prev":"next"}}))}return a&&(n.defBtnPrev=a,a.addEventListener("click",(function(){return d("prev")}))),c&&(n.defBtnNext=c,c.addEventListener("click",(function(){return d("next")}))),n}(this.wrapperStoriesFs,t),this.optionsSfs=t,this.countFirstActiveSlides=this.getCountSlidesInWrapWindow(),this.countLastActiveSlides=this.slidesStoriesFs.length-this.getCountSlidesInWrapWindow(),this.initOffButton(),function(e,t){e.insertAdjacentHTML("afterbegin",'<div class="stories-fs__btn-close"></div>');var i=!1,s=e.querySelector(".stories-fs__btn-close"),n=document.querySelector("body");t.forEach((function(t,s){t.addEventListener("click",(function(){e.classList.add("fullscreen"),n.classList.add("overflow"),i||(e.dispatchEvent(new CustomEvent("changeFullScreenMode",{detail:{fullScreen:!0,activeIndex:s}})),i=!0)}))}));var r=function(){e.classList.remove("fullscreen"),n.classList.remove("overflow"),e.dispatchEvent(new CustomEvent("changeFullScreenMode",{detail:{fullScreen:!1}})),i=!1};s.addEventListener("click",r),window.addEventListener("keydown",(function(e){"Escape"===e.key&&r()}))}(this.wrapperStoriesFs,this.slidesStoriesFs),function(e,t){e.forEach((function(e){var i=e.querySelector(".stories-fs__sub-wrapper"),s=e.querySelectorAll(".stories-fs__inner"),n=t.storiesMode?"":"hide",r='<div class="stories-fs__progress '.concat(n,'"></div>');i.insertAdjacentHTML("afterbegin",r);for(var o=e.querySelector(".stories-fs__progress"),l=0;l<s.length;l++)o.insertAdjacentHTML("afterbegin",'\n            <div class="stories-fs__progress-item">\n                <div class="stories-fs__progress-bg"></div>\n            </div>')}))}(this.slidesStoriesFs,t),function(e,t){if(t.storiesMode){e.insertAdjacentHTML("afterbegin",'<div class="stories-fs__btn-item stories-fs__btn-item--prev"></div>\n    <div class="stories-fs__btn-item stories-fs__btn-item--next"></div>');var i=e.querySelector(".stories-fs__btn-item--prev"),s=e.querySelector(".stories-fs__btn-item--next");i.addEventListener("click",(function(){n("prev")})),s.addEventListener("click",(function(){n("next")}))}function n(t){e.dispatchEvent(new CustomEvent("clickBtnChangeItem",{detail:{btn:"prev"===t?"prev":"next"}}))}}(this.wrapperStoriesFs,t),function(e,t,i){if(!1!==i.swipeOnSlide){var s=null,n=null,r=null,o=!1;e.addEventListener("touchstart",(function(e){s=e.targetTouches[0].clientX,l()})),e.addEventListener("touchend",(function(e){n=e.changedTouches[0].clientX,d(s,n),a()})),e.addEventListener("mousedown",(function(e){s=e.clientX,l()})),e.addEventListener("mouseup",(function(e){n=e.clientX,d(s,n),a()}))}function l(){r=setTimeout((function(){c(!0),o=!0}),1e3)}function a(){clearTimeout(r),o&&(c(!1),o=!1)}function c(t){e.dispatchEvent(new CustomEvent("holdEvent",{detail:{holdEvent:!!t}}))}function d(t,i){Math.abs(t-i)<=30||e.dispatchEvent(new CustomEvent("changeSlide",{detail:{btn:t<i?"prev":"next"}}))}}(this.wrapperStoriesFs,this.slidesStoriesFs,t),function(e){e.style.height=e.clientHeight+"px"}(this.parentStoriesFs),function(e){var t=e.querySelectorAll(".stories-fs__inner img");if(!(t.length<=0)){var i=new IntersectionObserver((function(e,t){e.forEach((function(e){if(e.intersectionRatio>0||e.isIntersecting){var i=e.target;if(t.unobserve(i),!i.hasAttribute("data-src"))return;var s=i.getAttribute("data-src");i.setAttribute("src",s),t.unobserve(i)}}))}));t.forEach((function(e){i.observe(e)}))}}(this.wrapperStoriesFs),i=this.wrapperStoriesFs,this.slidesStoriesFs.forEach((function(e,t){e.querySelectorAll(".stories-fs__progress-item").forEach((function(e,s){e.addEventListener("click",(function(){!function(e,t){i.dispatchEvent(new CustomEvent("clickItem",{detail:{activeIndex:e,activeItem:t}}))}(t,s)}))}))})),this.paramPlayStory={wrapperStoriesFs:this.wrapperStoriesFs,slidesStoriesFs:this.slidesStoriesFs,optionsSfs:this.optionsSfs,activeIndex:this.activeIndexSlide,activeIndexStory:this.activeIndexStory},this.wrapperStoriesFs.addEventListener("holdEvent",(function(e){e.detail.holdEvent?o(s.storyTimersId):s.playStory()})),this.wrapperStoriesFs.addEventListener("changeSlide",(function(e){s.playAnimScroll||(s.activeIndexStory=0,"prev"===e.detail.btn&&s.prevSlide(),"next"===e.detail.btn&&s.nextSlide())})),this.wrapperStoriesFs.addEventListener("changeItem",(function(e){s.storyTimersId=e.detail.intervals,s.activeIndexStory=e.detail.index})),this.wrapperStoriesFs.addEventListener("clickItem",(function(e){s.fullScreenMode&&!s.playAnimScroll&&(s.activeIndexSlide=e.detail.activeIndex,s.activeIndexStory=e.detail.activeItem,s.playStory())})),this.wrapperStoriesFs.addEventListener("clickBtnChangeItem",(function(e){if(s.fullScreenMode&&!s.playAnimScroll){if(o(s.storyTimersId),"next"===e.detail.btn?s.activeIndexStory++:s.activeIndexStory--,s.activeIndexStory<0)return s.activeIndexStory=0,s.prevSlide();if(s.activeIndexSlide===s.slidesStoriesFs.length-1){var t=s.slidesStoriesFs[s.activeIndexSlide].querySelectorAll(".stories-fs__inner");if(s.activeIndexStory>=t.length)return s.wrapperStoriesFs.querySelector(".stories-fs__btn-close").click(),s.activeIndexStory=t.length}s.playStory()}})),this.wrapperStoriesFs.addEventListener("endAnimationSlide",(function(e){s.storyTimersId=e.detail.intervals,s.activeIndexStory=0,s.activeIndexSlide<s.slidesStoriesFs.length-1&&s.updateStory(),e.detail.activeSlide===s.activeIndexSlide&&s.fullScreenMode&&s.nextSlide()})),void this.wrapperStoriesFs.addEventListener("changeFullScreenMode",(function(e){(e.detail.activeIndex||0===e.detail.activeIndex)&&(s.activeIndexSlide=e.detail.activeIndex),s.widthSlide=a(s.wrapperStoriesFs,s.slidesStoriesFs,t,e.detail.fullScreen),s.countFirstActiveSlides=s.getCountSlidesInWrapWindow(),s.countLastActiveSlides=s.slidesStoriesFs.length-s.countFirstActiveSlides,s.countScrollWrapper=0,s.fullScreenMode=e.detail.fullScreen,s.scrollTrackOnActiveSlide(s.activeIndexSlide)})))},e.prototype.prevSlide=function(){this.scrollTrack(this.activeIndexSlide-1)},e.prototype.nextSlide=function(){this.scrollTrack(this.activeIndexSlide+1)},e.prototype.scrollTrack=function(e){if(!this.playAnimScroll&&!(e<0||e>this.slidesStoriesFs.length-1||this.countLastActiveSlides<0)){this.updateStory();var t,o,a,c,d,u=this.optionsSfs.speedAnimNextSlide;e>this.activeIndexSlide?(this.activeIndexSlide++,t="next"):(this.activeIndexSlide--,t="prev"),c=(o=this.countScrollWrapper)<(a=this.countScrollWrapper="next"===t?o+this.widthSlide:o-this.widthSlide)?Math.ceil((a-o)/u):Math.ceil((o-a)/u),d=(this.slidesStoriesFs.length-this.countFirstActiveSlides)*this.widthSlide,l(a,0)<=0?(i(this.arrowsBtnEl),this.activeIndexSlide=0):s(this.arrowsBtnEl),l(a,0)>=l(d,0)?(n(this.arrowsBtnEl),this.activeIndexSlide=this.slidesStoriesFs.length-1):r(this.arrowsBtnEl),l(a,0)<=l(d,0)&&this.scrollTrackAnimation(o,a,c,t),this.fullScreenMode&&this.playStory()}},e.prototype.scrollTrackOnActiveSlide=function(e){var t=this.widthSlide*e;0===e?(t=0,i(this.arrowsBtnEl)):s(this.arrowsBtnEl),e>this.countLastActiveSlides&&this.countLastActiveSlides>0?(t=this.widthSlide*this.countLastActiveSlides,n(this.arrowsBtnEl)):r(this.arrowsBtnEl),e===this.slidesStoriesFs.length-1&&n(this.arrowsBtnEl),this.countLastActiveSlides<0&&(i(this.arrowsBtnEl),n(this.arrowsBtnEl),t=0),this.trackStoriesFs.style.transform="translate(".concat(-1*t+"px",", 0)"),this.countScrollWrapper=t,this.fullScreenMode?this.playStory():this.updateStory()},e.prototype.scrollTrackAnimation=function(e,t,i,s){var n=this;this.playAnimScroll=!0,this.timerId=setInterval((function(){n.trackStoriesFs.style.transform="translate(".concat(-1*e+"px",", 0)"),"next"==s?e+=i:e-=i,("next"===s&&e>=t||"prev"===s&&e<=t)&&(n.trackStoriesFs.style.transform="translate(".concat(-1*t+"px",", 0)"),clearInterval(n.timerId),n.playAnimScroll=!1)}),1)},e.prototype.playStory=function(){this.updateStory(),this.updateIndex(),function(e){var t=e.slidesStoriesFs[e.activeIndex],i=e.optionsSfs;console.log(i.speedStory/100);var s=i.speedStory/100,n=t.querySelectorAll(".stories-fs__progress-item"),r=t.querySelectorAll(".stories-fs__progress-bg"),o=t.querySelectorAll(".stories-fs__inner");if(!(n.length<=0||o.length<=0||n.length!==o.length)){var l=n.length-1,a=e.activeIndexStory,c=null;return function e(t){if(a>l)return d();o[t].classList.add("active"),function(t){var n=r[t],o=1,v=1;c=setInterval((function(){n.style.width=o+"%",(o+=v)>100&&(clearInterval(c),++a<=l&&(e(a),u(a)),a>l&&i.autoPlayFullScreen&&d())}),s)}(t),u(t)}(a),{interval:[c]}}function d(){e.wrapperStoriesFs.dispatchEvent(new CustomEvent("endAnimationSlide",{detail:{animSlide:!1,activeSlide:e.activeIndex,intervals:[c]}}))}function u(t){e.wrapperStoriesFs.dispatchEvent(new CustomEvent("changeItem",{detail:{intervals:[c],index:t}}))}}(this.paramPlayStory)},e.prototype.updateStory=function(){!function(e,t,i,s){if(!(0===t&&-1===i||t>e.length-1)){var n=e[t],r=n.querySelectorAll(".stories-fs__progress-item"),o=n.querySelectorAll(".stories-fs__inner");r.forEach((function(e){e.classList.contains("active")&&e.classList.remove("active")}));for(var l=0;l<r.length;l++)r[l].classList.contains("active")&&r[l].classList.remove("active"),o[l].classList.contains("active")&&o[l].classList.remove("active");null!==s&&s.forEach((function(e){clearInterval(e)}))}}(this.slidesStoriesFs,this.activeIndexSlide,this.activeIndexStory,this.storyTimersId)},e.prototype.updateIndex=function(){this.paramPlayStory.activeIndex=this.activeIndexSlide,this.paramPlayStory.activeIndexStory=this.activeIndexStory},e.prototype.getCountSlidesInWrapWindow=function(){return this.wrapperStoriesFs.clientWidth/this.widthSlide},e.prototype.initOffButton=function(){i(this.arrowsBtnEl),this.countFirstActiveSlides>=this.slidesStoriesFs.length&&n(this.arrowsBtnEl)},e}();return t.default})()));